# 流程图编辑页 - 页面控件说明

## 1. 页面级说明

### 1.1 页面骨架结构

```
┌─────────────────────────────────────────────────────────────────────┐
│ Header (56px)                                                       │
│ [←返回] [项目名] [撤销] [重做] [预览] [导出] [保存]                   │
├──────────┬──────────────────────────────────────────┬───────────────┤
│ Node     │ Canvas                                   │ Properties    │
│ Library  │                                          │ Panel         │
│ (200px)  │  ┌─────┐                                 │ (280px)       │
│          │  │开始 │──→──┌─────┐                      │               │
│ 基础节点 │  └─────┘    │页面 │                      │ 节点属性       │
│ - 开始   │              └─────┘                      │ - 名称        │
│ - 结束   │              │                           │ - 类型        │
│ - 任务   │              ▼                           │ - 描述        │
│          │           ┌─────┐                        │               │
│ 页面节点 │           │判断 │                        │ 页面预览       │
│ - 页面   │           └─────┘                        │               │
│          │              │                           │               │
│ 逻辑节点 │              ▼                           │               │
│ - 判断   │           ┌─────┐                        │               │
│ - 子流程 │           │结束 │                        │               │
│          │           └─────┘                        │               │
│          │                                          │               │
│          │         [缩放控件: - [100%] +]           │               │
└──────────┴──────────────────────────────────────────┴───────────────┘
```

### 1.2 节点类型定义

| 节点类型 | 形状 | 颜色 | 用途 |
|----------|------|------|------|
| 开始 | 圆角矩形 | #d9f7be (浅绿) | 流程起点 |
| 结束 | 圆角矩形 | #ffccc7 (浅红) | 流程终点 |
| 页面 | 矩形 | #bae7ff (浅蓝) | 页面/视图 |
| 判断 | 菱形 | #ffe58f (浅黄) | 条件分支 |
| 任务 | 矩形 | #f0f0f0 (灰) | 普通任务 |
| 子流程 | 大矩形 | #efdbff (浅紫) | 子流程 |

### 1.3 全局 CSS 样式

```css
.canvas {
  background: var(--bg-light);
  position: relative;
  overflow: hidden;
}

.canvas-grid {
  background-image: radial-gradient(circle, #ddd 1px, transparent 1px);
  background-size: 20px 20px;
}

.flow-node {
  position: absolute;
  padding: 12px 20px;
  border-radius: 8px;
  cursor: move;
  min-width: 120px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.flow-node.selected {
  box-shadow: 0 0 0 2px var(--primary);
}
```

---

## 2. 控件级说明

### 2.1 Header 组件

| 控件 | 类型 | 交互 | 数据 |
|------|------|------|------|
| 返回 | icon-btn | click → 项目列表 | - |
| 项目名 | text | - | project.flowchart.name |
| 撤销 | icon-btn | click → 撤销 | history.prev |
| 重做 | icon-btn | click → 重做 | history.next |
| 预览 | button | click → 预览模式 | - |
| 导出 | button | click → 导出弹窗 | - |
| 保存 | button | click → 保存 | flowchart.data |

### 2.2 节点库

| 控件 | 类型 | 交互 | 数据 |
|------|------|------|------|
| 节点项 | draggable | dragstart → 添加节点 | node.type |

**拖拽数据**:
```javascript
{
  type: "page" | "decision" | "start" | "end" | "task",
  defaultLabel: "新节点"
}
```

### 2.3 画布

| 控件 | 类型 | 交互 | 数据 |
|------|------|------|------|
| 节点 | draggable | drag → 移动位置 | node.x, node.y |
| 连接线 | SVG path | - | from → to |
| 网格背景 | background | - | 20px 间距 |
| 缩放 | buttons | +/- → 缩放 | zoom: 50%-200% |

**节点数据结构**:
```javascript
{
  id: "node_001",
  type: "page",
  label: "用户登录",
  x: 260,
  y: 130,
  description: "用户登录页面",
  pageId: "page_001"
}
```

### 2.4 属性面板

| 控件 | 类型 | 交互 | 数据 |
|------|------|------|------|
| 节点名称 | input | blur → 更新 | node.label |
| 节点类型 | input (disabled) | - | node.type |
| 描述 | textarea | blur → 更新 | node.description |
| 页面预览 | preview | click → 跳转 | node.pageId |

---

## 3. 静态代码文件

| 文件 | 说明 |
|------|------|
| index.html | 完整页面 HTML + 内联 CSS |

---

## 4. 交互说明

| 操作 | 行为 |
|------|------|
| 拖拽节点 | 从左侧拖入画布 |
| 移动节点 | 拖动画布上的节点 |
| 选中节点 | 点击节点，显示属性 |
| 删除节点 | 选中 + Delete 键 |
| 连接节点 | 从节点边缘拖出线条 |
| 缩放 | 底部按钮或滚轮 |

---

## 5. 页面状态

| 状态 | 说明 |
|------|------|
| default | 空闲 |
| dragging | 拖拽中 |
| connecting | 连接中 |
| selected | 节点选中 |
| editing | 编辑属性中 |
